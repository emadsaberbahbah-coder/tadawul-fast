<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tadawul Fast Bridge v4.0 - Saudi Market Data API Dashboard</title>
  <meta name="description" content="Enhanced real-time Saudi stock market data API with Google Sheets integration. Comprehensive dashboard with monitoring and analytics.">
  <meta name="keywords" content="Tadawul, Saudi Arabia, Stock Market, API, Google Sheets, Financial Data, Dashboard">
  
  <!-- Open Graph / Social Media Meta Tags -->
  <meta property="og:title" content="Tadawul Fast Bridge v4.0">
  <meta property="og:description" content="Real-time Saudi stock market data API dashboard">
  <meta property="og:type" content="website">
  
  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìä</text></svg>">
  
  <style>
    /* CSS Variables with Enhanced Color Scheme */
    :root {
      /* Primary Colors */
      --primary-50: #eff6ff;
      --primary-100: #dbeafe;
      --primary-200: #bfdbfe;
      --primary-300: #93c5fd;
      --primary-400: #60a5fa;
      --primary-500: #3b82f6;
      --primary-600: #2563eb;
      --primary-700: #1d4ed8;
      --primary-800: #1e40af;
      --primary-900: #1e3a8a;
      
      /* Secondary Colors */
      --secondary-50: #f0fdf4;
      --secondary-100: #dcfce7;
      --secondary-200: #bbf7d0;
      --secondary-300: #86efac;
      --secondary-400: #4ade80;
      --secondary-500: #22c55e;
      --secondary-600: #16a34a;
      --secondary-700: #15803d;
      --secondary-800: #166534;
      --secondary-900: #14532d;
      
      /* Neutral Colors */
      --neutral-50: #f8fafc;
      --neutral-100: #f1f5f9;
      --neutral-200: #e2e8f0;
      --neutral-300: #cbd5e1;
      --neutral-400: #94a3b8;
      --neutral-500: #64748b;
      --neutral-600: #475569;
      --neutral-700: #334155;
      --neutral-800: #1e293b;
      --neutral-900: #0f172a;
      --neutral-950: #020617;
      
      /* Semantic Colors */
      --success: var(--secondary-500);
      --warning: #f59e0b;
      --error: #ef4444;
      --info: var(--primary-500);
      
      /* Background & Surface */
      --background: var(--neutral-950);
      --surface-1: var(--neutral-900);
      --surface-2: var(--neutral-800);
      --surface-3: var(--neutral-700);
      
      /* Text Colors */
      --text-primary: var(--neutral-100);
      --text-secondary: var(--neutral-300);
      --text-tertiary: var(--neutral-400);
      --text-muted: var(--neutral-500);
      
      /* Border Colors */
      --border-light: var(--neutral-700);
      --border-medium: var(--neutral-600);
      --border-dark: var(--neutral-500);
      
      /* Shadow System */
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      
      /* Spacing */
      --space-1: 0.25rem;
      --space-2: 0.5rem;
      --space-3: 0.75rem;
      --space-4: 1rem;
      --space-5: 1.25rem;
      --space-6: 1.5rem;
      --space-8: 2rem;
      --space-10: 2.5rem;
      --space-12: 3rem;
      --space-16: 4rem;
      
      /* Typography */
      --font-sans: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      --font-mono: 'SF Mono', Monaco, 'Cascadia Mono', 'Segoe UI Mono', 'Roboto Mono', 'Ubuntu Mono', monospace;
      --font-heading: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      
      /* Border Radius */
      --radius-sm: 0.25rem;
      --radius-md: 0.5rem;
      --radius-lg: 0.75rem;
      --radius-xl: 1rem;
      --radius-2xl: 1.5rem;
      --radius-full: 9999px;
      
      /* Transitions */
      --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition-normal: 300ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition-slow: 500ms cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Reset & Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      font-size: 16px;
      scroll-behavior: smooth;
    }

    body {
      font-family: var(--font-sans);
      background: var(--background);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      padding: 0;
    }

    /* Container System */
    .container {
      width: 100%;
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 var(--space-4);
    }

    @media (min-width: 640px) {
      .container {
        padding: 0 var(--space-6);
      }
    }

    @media (min-width: 1024px) {
      .container {
        padding: 0 var(--space-8);
      }
    }

    /* Typography */
    h1, h2, h3, h4, h5, h6 {
      font-family: var(--font-heading);
      font-weight: 700;
      line-height: 1.2;
      margin-bottom: var(--space-4);
    }

    h1 {
      font-size: 3rem;
      font-weight: 800;
      letter-spacing: -0.025em;
    }

    h2 {
      font-size: 2.25rem;
      letter-spacing: -0.025em;
    }

    h3 {
      font-size: 1.875rem;
    }

    h4 {
      font-size: 1.5rem;
    }

    p {
      margin-bottom: var(--space-4);
    }

    /* Layout Components */
    .dashboard {
      display: grid;
      grid-template-columns: 1fr;
      gap: var(--space-6);
      padding: var(--space-6) 0;
    }

    @media (min-width: 1024px) {
      .dashboard {
        grid-template-columns: 2fr 1fr;
        gap: var(--space-8);
      }
    }

    .main-content {
      display: flex;
      flex-direction: column;
      gap: var(--space-6);
    }

    .sidebar {
      display: flex;
      flex-direction: column;
      gap: var(--space-6);
    }

    /* Cards */
    .card {
      background: var(--surface-1);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-xl);
      padding: var(--space-6);
      box-shadow: var(--shadow-xl);
      transition: all var(--transition-normal);
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-2xl);
      border-color: var(--primary-600);
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: var(--space-4);
      padding-bottom: var(--space-4);
      border-bottom: 1px solid var(--border-light);
    }

    .card-title {
      display: flex;
      align-items: center;
      gap: var(--space-3);
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .card-icon {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: var(--radius-md);
      background: var(--primary-500);
      color: white;
      font-size: 0.875rem;
    }

    .card-content {
      margin-top: var(--space-4);
    }

    /* Badges */
    .badge {
      display: inline-flex;
      align-items: center;
      padding: var(--space-1) var(--space-3);
      border-radius: var(--radius-full);
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      gap: var(--space-2);
    }

    .badge::before {
      content: "";
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: currentColor;
      animation: pulse 2s infinite;
    }

    .badge-success {
      background: rgba(34, 197, 94, 0.15);
      color: var(--success);
      border: 1px solid rgba(34, 197, 94, 0.3);
    }

    .badge-warning {
      background: rgba(245, 158, 11, 0.15);
      color: var(--warning);
      border: 1px solid rgba(245, 158, 11, 0.3);
    }

    .badge-error {
      background: rgba(239, 68, 68, 0.15);
      color: var(--error);
      border: 1px solid rgba(239, 68, 68, 0.3);
    }

    .badge-info {
      background: rgba(59, 130, 246, 0.15);
      color: var(--info);
      border: 1px solid rgba(59, 130, 246, 0.3);
    }

    .badge-neutral {
      background: rgba(100, 116, 139, 0.15);
      color: var(--text-tertiary);
      border: 1px solid rgba(100, 116, 139, 0.3);
    }

    /* Status Display */
    .status-display {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: var(--space-4);
      margin: var(--space-4) 0;
    }

    .status-item {
      background: var(--surface-2);
      border-radius: var(--radius-lg);
      padding: var(--space-4);
      text-align: center;
      border: 1px solid var(--border-light);
    }

    .status-value {
      font-size: 1.875rem;
      font-weight: 700;
      margin-bottom: var(--space-1);
      font-feature-settings: "tnum";
      font-variant-numeric: tabular-nums;
    }

    .status-label {
      font-size: 0.75rem;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .status-delta {
      font-size: 0.75rem;
      margin-top: var(--space-1);
    }

    .status-delta.positive {
      color: var(--success);
    }

    .status-delta.negative {
      color: var(--error);
    }

    /* Service Status */
    .service-status {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--space-3);
      margin-top: var(--space-4);
    }

    .service-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-3);
      background: var(--surface-2);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-light);
    }

    .service-info {
      display: flex;
      align-items: center;
      gap: var(--space-3);
    }

    .service-icon {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-lg);
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--surface-3);
      color: var(--text-primary);
    }

    .service-name {
      font-weight: 500;
    }

    .service-desc {
      font-size: 0.75rem;
      color: var(--text-tertiary);
    }

    /* API Endpoints */
    .endpoints-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: var(--space-2);
      margin-top: var(--space-4);
    }

    @media (min-width: 768px) {
      .endpoints-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .endpoint-item {
      background: var(--surface-2);
      border-radius: var(--radius-lg);
      padding: var(--space-3);
      border: 1px solid var(--border-light);
      transition: all var(--transition-fast);
      cursor: pointer;
    }

    .endpoint-item:hover {
      background: var(--surface-3);
      border-color: var(--primary-500);
    }

    .endpoint-header {
      display: flex;
      align-items: center;
      gap: var(--space-3);
      margin-bottom: var(--space-2);
    }

    .endpoint-method {
      padding: var(--space-1) var(--space-2);
      border-radius: var(--radius-sm);
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      min-width: 64px;
      text-align: center;
    }

    .method-get {
      background: rgba(34, 197, 94, 0.15);
      color: var(--success);
      border: 1px solid rgba(34, 197, 94, 0.3);
    }

    .method-post {
      background: rgba(59, 130, 246, 0.15);
      color: var(--info);
      border: 1px solid rgba(59, 130, 246, 0.3);
    }

    .method-put {
      background: rgba(245, 158, 11, 0.15);
      color: var(--warning);
      border: 1px solid rgba(245, 158, 11, 0.3);
    }

    .method-delete {
      background: rgba(239, 68, 68, 0.15);
      color: var(--error);
      border: 1px solid rgba(239, 68, 68, 0.3);
    }

    .endpoint-path {
      font-family: var(--font-mono);
      font-size: 0.875rem;
      color: var(--text-primary);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .endpoint-desc {
      font-size: 0.875rem;
      color: var(--text-tertiary);
      line-height: 1.4;
    }

    /* Metrics Charts */
    .metrics-chart {
      background: var(--surface-2);
      border-radius: var(--radius-lg);
      padding: var(--space-4);
      margin-top: var(--space-4);
    }

    .chart-placeholder {
      height: 150px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--surface-3);
      border-radius: var(--radius-md);
      color: var(--text-tertiary);
      font-size: 0.875rem;
    }

    /* Navigation */
    .nav-header {
      position: sticky;
      top: 0;
      z-index: 50;
      background: rgba(2, 6, 23, 0.8);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid var(--border-light);
      padding: var(--space-4) 0;
    }

    .nav-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .nav-brand {
      display: flex;
      align-items: center;
      gap: var(--space-3);
      text-decoration: none;
    }

    .brand-logo {
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, var(--primary-500), var(--secondary-500));
      border-radius: var(--radius-lg);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
    }

    .brand-text {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--text-primary);
    }

    .nav-links {
      display: flex;
      gap: var(--space-4);
      align-items: center;
    }

    .nav-link {
      color: var(--text-secondary);
      text-decoration: none;
      font-size: 0.875rem;
      font-weight: 500;
      padding: var(--space-2) var(--space-3);
      border-radius: var(--radius-md);
      transition: all var(--transition-fast);
    }

    .nav-link:hover {
      color: var(--text-primary);
      background: var(--surface-2);
    }

    /* Footer */
    .footer {
      margin-top: auto;
      background: var(--surface-1);
      border-top: 1px solid var(--border-light);
      padding: var(--space-6) 0;
    }

    .footer-content {
      display: grid;
      grid-template-columns: 1fr;
      gap: var(--space-6);
    }

    @media (min-width: 768px) {
      .footer-content {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    .footer-section h4 {
      font-size: 1rem;
      margin-bottom: var(--space-3);
      color: var(--text-primary);
    }

    .footer-links {
      list-style: none;
    }

    .footer-links li {
      margin-bottom: var(--space-2);
    }

    .footer-links a {
      color: var(--text-tertiary);
      text-decoration: none;
      font-size: 0.875rem;
      transition: color var(--transition-fast);
    }

    .footer-links a:hover {
      color: var(--text-primary);
    }

    .tech-tags {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-2);
      margin-top: var(--space-3);
    }

    .tech-tag {
      padding: var(--space-1) var(--space-2);
      background: var(--surface-3);
      border-radius: var(--radius-md);
      font-size: 0.75rem;
      color: var(--text-tertiary);
    }

    /* Animations */
    @keyframes pulse {
      0%, 100 { opacity: 1; }
      50% { opacity: 0.5; }
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes slideIn {
      from { transform: translateX(-10px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    /* Utility Classes */
    .animate-fade-in {
      animation: fadeIn 0.5s ease-out;
    }

    .animate-slide-in {
      animation: slideIn 0.3s ease-out;
    }

    .gradient-text {
      background: linear-gradient(135deg, var(--primary-500), var(--secondary-500));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .text-gradient {
      background: linear-gradient(135deg, var(--primary-500), var(--secondary-500));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .glass-effect {
      background: rgba(30, 41, 59, 0.7);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Responsive Adjustments */
    @media (max-width: 768px) {
      h1 {
        font-size: 2.25rem;
      }
      
      h2 {
        font-size: 1.875rem;
      }
      
      .card {
        padding: var(--space-4);
      }
      
      .dashboard {
        padding: var(--space-4) 0;
      }
      
      .nav-links {
        display: none;
      }
    }

    @media (max-width: 480px) {
      h1 {
        font-size: 1.875rem;
      }
      
      .status-display {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--surface-2);
      border-radius: var(--radius-full);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--neutral-600);
      border-radius: var(--radius-full);
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--neutral-500);
    }
  </style>
</head>
<body>
  <!-- Navigation Header -->
  <header class="nav-header">
    <nav class="container nav-container">
      <a href="#" class="nav-brand">
        <div class="brand-logo">T</div>
        <span class="brand-text">Tadawul Fast Bridge</span>
      </a>
      <div class="nav-links">
        <a href="#api" class="nav-link">API Reference</a>
        <a href="#status" class="nav-link">System Status</a>
        <a href="#metrics" class="nav-link">Metrics</a>
        <a href="/docs" class="nav-link" target="_blank" rel="noopener">Documentation</a>
      </div>
    </nav>
  </header>

  <!-- Main Content -->
  <main class="container">
    <div class="dashboard">
      <!-- Left Column - Main Content -->
      <div class="main-content">
        <!-- Hero Section -->
        <div class="card animate-fade-in">
          <div class="card-header">
            <div class="card-title">
              <div class="card-icon">üöÄ</div>
              <h1>Tadawul Fast Bridge <span class="gradient-text">v4.0.0</span></h1>
            </div>
            <div class="badge badge-neutral" id="systemStatus">
              <span id="statusText">Initializing...</span>
            </div>
          </div>
          
          <div class="card-content">
            <p class="text-gradient" style="font-size: 1.125rem; font-weight: 500; margin-bottom: var(--space-4);">
              Advanced real-time Saudi stock market data API with comprehensive monitoring and analytics.
            </p>
            
            <div class="features-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-4); margin: var(--space-6) 0;">
              <div class="feature-card" style="padding: var(--space-4); background: var(--surface-2); border-radius: var(--radius-lg);">
                <div style="font-size: 1.5rem; margin-bottom: var(--space-2);">üìà</div>
                <div style="font-weight: 600; margin-bottom: var(--space-1);">Real-time Market Data</div>
                <div style="font-size: 0.875rem; color: var(--text-tertiary);">Live quotes, volumes, and market indicators</div>
              </div>
              
              <div class="feature-card" style="padding: var(--space-4); background: var(--surface-2); border-radius: var(--radius-lg);">
                <div style="font-size: 1.5rem; margin-bottom: var(--space-2);">üíæ</div>
                <div style="font-weight: 600; margin-bottom: var(--space-1);">Smart Caching</div>
                <div style="font-size: 0.875rem; color: var(--text-tertiary);">Redis + in-memory cache with TTL management</div>
              </div>
              
              <div class="feature-card" style="padding: var(--space-4); background: var(--surface-2); border-radius: var(--radius-lg);">
                <div style="font-size: 1.5rem; margin-bottom: var(--space-2);">üîÑ</div>
                <div style="font-weight: 600; margin-bottom: var(--space-1);">Async Processing</div>
                <div style="font-size: 0.875rem; color: var(--text-tertiary);">Full async/await FastAPI architecture</div>
              </div>
              
              <div class="feature-card" style="padding: var(--space-4); background: var(--surface-2); border-radius: var(--radius-lg);">
                <div style="font-size: 1.5rem; margin-bottom: var(--space-2);">üìä</div>
                <div style="font-weight: 600; margin-bottom: var(--space-1);">Data Validation</div>
                <div style="font-size: 0.875rem; color: var(--text-tertiary);">Pydantic models & quality assessment</div>
              </div>
            </div>
          </div>
        </div>

        <!-- API Endpoints Section -->
        <div class="card" id="api">
          <div class="card-header">
            <div class="card-title">
              <div class="card-icon">üîå</div>
              <h3>API Endpoints (v1)</h3>
            </div>
          </div>
          
          <div class="card-content">
            <div class="endpoints-grid">
              <!-- Health & Monitoring -->
              <div class="endpoint-item animate-slide-in">
                <div class="endpoint-header">
                  <span class="endpoint-method method-get">GET</span>
                  <span class="endpoint-path">/health</span>
                </div>
                <div class="endpoint-desc">Service health status, uptime, and basic dependencies.</div>
              </div>
              
              <div class="endpoint-item animate-slide-in">
                <div class="endpoint-header">
                  <span class="endpoint-method method-get">GET</span>
                  <span class="endpoint-path">/metrics</span>
                </div>
                <div class="endpoint-desc">Prometheus-compatible metrics (for monitoring stacks).</div>
              </div>
              
              <div class="endpoint-item animate-slide-in">
                <div class="endpoint-header">
                  <span class="endpoint-method method-get">GET</span>
                  <span class="endpoint-path">/api/v1/system/info</span>
                </div>
                <div class="endpoint-desc">Application + system info (CPU, memory, providers, cache).</div>
              </div>

              <!-- Market Data / Stocks -->
              <div class="endpoint-item animate-slide-in">
                <div class="endpoint-header">
                  <span class="endpoint-method method-get">GET</span>
                  <span class="endpoint-path">/api/v1/stocks/{symbol}</span>
                </div>
                <div class="endpoint-desc">Get stock snapshot (price, change, volume, caps, etc.).</div>
              </div>
              
              <div class="endpoint-item animate-slide-in">
                <div class="endpoint-header">
                  <span class="endpoint-method method-post">POST</span>
                  <span class="endpoint-path">/api/v1/stocks/batch</span>
                </div>
                <div class="endpoint-desc">Batch stock lookup for up to 50 symbols in one request.</div>
              </div>
              
              <div class="endpoint-item animate-slide-in">
                <div class="endpoint-header">
                  <span class="endpoint-method method-get">GET</span>
                  <span class="endpoint-path">/api/v1/analysis/technical/{symbol}</span>
                </div>
                <div class="endpoint-desc">Sample technical indicators (RSI, MACD, MAs).</div>
              </div>
              
              <!-- Google Sheets / Export -->
              <div class="endpoint-item animate-slide-in">
                <div class="endpoint-header">
                  <span class="endpoint-method method-post">POST</span>
                  <span class="endpoint-path">/api/v1/export/sheets</span>
                </div>
                <div class="endpoint-desc">Export a list of symbols into your configured Google Sheet.</div>
              </div>

              <!-- Cache & System -->
              <div class="endpoint-item animate-slide-in">
                <div class="endpoint-header">
                  <span class="endpoint-method method-get">GET</span>
                  <span class="endpoint-path">/api/v1/cache/stats</span>
                </div>
                <div class="endpoint-desc">Cache backend, memory usage, and Redis key statistics.</div>
              </div>
              
              <!-- WebSocket & Docs -->
              <div class="endpoint-item animate-slide-in">
                <div class="endpoint-header">
                  <span class="endpoint-method method-get">GET</span>
                  <span class="endpoint-path">/ws</span>
                </div>
                <div class="endpoint-desc">WebSocket endpoint for streaming real-time stock updates.</div>
              </div>

              <div class="endpoint-item animate-slide-in">
                <div class="endpoint-header">
                  <span class="endpoint-method method-get">GET</span>
                  <span class="endpoint-path">/docs</span>
                </div>
                <div class="endpoint-desc">Interactive Swagger UI documentation (FastAPI).</div>
              </div>
              
              <div class="endpoint-item animate-slide-in">
                <div class="endpoint-header">
                  <span class="endpoint-method method-get">GET</span>
                  <span class="endpoint-path">/redoc</span>
                </div>
                <div class="endpoint-desc">ReDoc-based API documentation.</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Column - Sidebar -->
      <div class="sidebar">
        <!-- System Status Card -->
        <div class="card" id="status">
          <div class="card-header">
            <div class="card-title">
              <div class="card-icon">‚ö°</div>
              <h3>System Status</h3>
            </div>
          </div>
          
          <div class="card-content">
            <div class="status-display">
              <div class="status-item">
                <div class="status-value" id="responseTime">--</div>
                <div class="status-label">Health Latency</div>
                <div class="status-delta" id="responseDelta">ms</div>
              </div>
              
              <div class="status-item">
                <div class="status-value" id="uptime">--</div>
                <div class="status-label">Uptime</div>
                <div class="status-delta" id="uptimeDelta">since start</div>
              </div>
              
              <div class="status-item">
                <div class="status-value" id="requests">--</div>
                <div class="status-label">Requests* (info)</div>
                <div class="status-delta" id="requestsDelta">N/A</div>
              </div>
              
              <div class="status-item">
                <div class="status-value" id="cacheHits">--</div>
                <div class="status-label">Cache Backend</div>
                <div class="status-delta" id="cacheDelta">N/A</div>
              </div>
            </div>
            
            <div class="service-status">
              <div class="service-item">
                <div class="service-info">
                  <div class="service-icon">üìä</div>
                  <div>
                    <div class="service-name">Google Sheets</div>
                    <div class="service-desc">Market data source</div>
                  </div>
                </div>
                <div class="badge badge-neutral" id="sheetsStatus">Unknown</div>
              </div>
              
              <div class="service-item">
                <div class="service-info">
                  <div class="service-icon">üîÑ</div>
                  <div>
                    <div class="service-name">Google Apps Script</div>
                    <div class="service-desc">Sheet automation</div>
                  </div>
                </div>
                <div class="badge badge-neutral" id="gasStatus">Unknown</div>
              </div>
              
              <div class="service-item">
                <div class="service-info">
                  <div class="service-icon">üíæ</div>
                  <div>
                    <div class="service-name">Cache</div>
                    <div class="service-desc">Redis + in-memory</div>
                  </div>
                </div>
                <div class="badge badge-neutral" id="cacheStatus">Checking</div>
              </div>
              
              <div class="service-item">
                <div class="service-info">
                  <div class="service-icon">‚ö°</div>
                  <div>
                    <div class="service-name">API Server</div>
                    <div class="service-desc">FastAPI backend</div>
                  </div>
                </div>
                <div class="badge badge-neutral" id="apiStatus">Checking</div>
              </div>
            </div>
            
            <div class="metrics-chart" id="metrics">
              <div class="card-header">
                <div class="card-title">
                  <div class="card-icon">üìà</div>
                  <h4>Performance Snapshot</h4>
                </div>
              </div>
              <div class="chart-placeholder">
                Metrics summary will appear here (CPU, memory, connections).
              </div>
            </div>
          </div>
        </div>

        <!-- Version & Environment Card -->
        <div class="card">
          <div class="card-header">
            <div class="card-title">
              <div class="card-icon">‚ÑπÔ∏è</div>
              <h3>Version Info</h3>
            </div>
          </div>
          
          <div class="card-content">
            <div style="font-family: var(--font-mono);">
              <div style="margin-bottom: var(--space-3);">
                <div style="font-size: 0.75rem; color: var(--text-tertiary);">Version</div>
                <div style="font-size: 1rem; font-weight: 600;" id="versionDisplay">Tadawul Fast Bridge v4.0.0</div>
              </div>
              
              <div style="margin-bottom: var(--space-3);">
                <div style="font-size: 0.75rem; color: var(--text-tertiary);">Environment</div>
                <div style="font-size: 1rem; font-weight: 600;" id="environmentDisplay">unknown</div>
              </div>
              
              <div style="margin-bottom: var(--space-3);">
                <div style="font-size: 0.75rem; color: var(--text-tertiary);">Build Date</div>
                <div style="font-size: 1rem; font-weight: 600;" id="buildDate">2024-01-15</div>
              </div>
              
              <div style="margin-top: var(--space-4); padding-top: var(--space-4); border-top: 1px solid var(--border-light);">
                <div style="font-size: 0.75rem; color: var(--text-tertiary);">System ID</div>
                <div style="font-size: 0.875rem; font-family: var(--font-mono); word-break: break-all;" id="systemId">system-id-placeholder</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h4>Tadawul Fast Bridge</h4>
          <p style="font-size: 0.875rem; color: var(--text-tertiary);">
            Advanced API for real-time Saudi stock market data with comprehensive monitoring and analytics.
          </p>
          <div class="tech-tags">
            <span class="tech-tag">FastAPI</span>
            <span class="tech-tag">Python 3.11+</span>
            <span class="tech-tag">Google Sheets</span>
            <span class="tech-tag">Async/Await</span>
            <span class="tech-tag">Redis</span>
            <span class="tech-tag">Docker</span>
            <span class="tech-tag">Monitoring</span>
            <span class="tech-tag">Prometheus</span>
          </div>
        </div>
        
        <div class="footer-section">
          <h4>Quick Links</h4>
          <ul class="footer-links">
            <li><a href="#api">API Reference</a></li>
            <li><a href="#status">System Status</a></li>
            <li><a href="#metrics">Metrics Snapshot</a></li>
            <li><a href="/docs" target="_blank" rel="noopener">Swagger Docs</a></li>
            <li><a href="/redoc" target="_blank" rel="noopener">ReDoc Docs</a></li>
          </ul>
        </div>
        
        <div class="footer-section">
          <h4>Data Sources</h4>
          <ul class="footer-links">
            <li>Google Sheets Integration</li>
            <li>Multi-provider Market APIs</li>
            <li>Tadawul Fast Bridge Provider</li>
            <li>Internal Ranking Engine</li>
            <li>Real-time Market Feeds</li>
          </ul>
        </div>
      </div>
      
      <div style="margin-top: var(--space-8); padding-top: var(--space-4); border-top: 1px solid var(--border-light); text-align: center; color: var(--text-tertiary); font-size: 0.875rem;">
        <p>¬© 2024 Tadawul Fast Bridge v4.0.0 ‚Ä¢ Built with modern async architecture</p>
        <p style="margin-top: var(--space-2);">System Status: <span id="footerStatus">Initializing...</span></p>
      </div>
    </div>
  </footer>

  <script>
    // Enhanced Dashboard JavaScript aligned with FastAPI v4.0 backend
    class DashboardMonitor {
      constructor() {
        this.config = {
          healthCheckInterval: 30000, // 30 seconds
          systemInfoInterval: 20000,  // 20 seconds
          apiBaseUrl: window.location.origin,
          historySize: 60,
        };
        
        this.state = {
          previousHealth: null,
          requestHistory: [],
          lastUpdate: null,
          version: '4.0.0',
        };
        
        this.cache = {
          healthData: null,
          systemInfo: null,
          cacheStats: null,
        };
        
        this.initialize();
      }
      
      initialize() {
        console.log('DashboardMonitor initialized');
        
        // Set initial version / build info
        document.getElementById('versionDisplay').textContent = `Tadawul Fast Bridge v${this.state.version}`;
        document.getElementById('buildDate').textContent = new Date().toISOString().split('T')[0];
        document.getElementById('systemId').textContent = this.generateSystemId();
        
        // Initial calls
        this.checkHealth();
        this.fetchSystemInfo();
        this.fetchCacheStats();
        
        // Periodic checks
        setInterval(() => this.checkHealth(), this.config.healthCheckInterval);
        setInterval(() => {
          this.fetchSystemInfo();
          this.fetchCacheStats();
        }, this.config.systemInfoInterval);
        
        // Manual refresh: Ctrl + R (inside app, without full browser reload)
        document.addEventListener('keydown', (e) => {
          if (e.key === 'r' && e.ctrlKey) {
            e.preventDefault();
            this.refreshAll();
          }
        });
      }
      
      generateSystemId() {
        const timestamp = Date.now().toString(36);
        const random = Math.random().toString(36).substr(2, 5);
        return `tfb-${timestamp}-${random}`;
      }
      
      async checkHealth() {
        const url = `${this.config.apiBaseUrl}/health`;
        try {
          const startTime = performance.now();
          const response = await fetch(url);
          const endTime = performance.now();
          const latency = Math.round(endTime - startTime);
          
          if (!response.ok) throw new Error(`Health ${response.status}`);
          
          const data = await response.json();
          this.cache.healthData = data;
          this.updateHealthDisplay(data, latency);
        } catch (error) {
          console.error('Health check failed:', error);
          this.handleHealthError();
        }
      }
      
      async fetchSystemInfo() {
        const url = `${this.config.apiBaseUrl}/api/v1/system/info`;
        try {
          const response = await fetch(url);
          if (!response.ok) throw new Error(`System info ${response.status}`);
          
          const data = await response.json();
          this.cache.systemInfo = data;
          this.updateSystemInfoDisplay(data);
        } catch (error) {
          console.warn('System info fetch failed:', error);
        }
      }
      
      async fetchCacheStats() {
        const url = `${this.config.apiBaseUrl}/api/v1/cache/stats`;
        try {
          const response = await fetch(url);
          if (!response.ok) throw new Error(`Cache stats ${response.status}`);
          
          const data = await response.json();
          this.cache.cacheStats = data;
          this.updateCacheDisplay(data);
        } catch (error) {
          console.warn('Cache stats fetch failed:', error);
        }
      }
      
      updateHealthDisplay(data, responseTime) {
        const statusElement = document.getElementById('systemStatus');
        const statusTextElement = document.getElementById('statusText');
        const footerStatusElement = document.getElementById('footerStatus');
        
        const isHealthy = data.status === 'healthy';
        statusElement.className = `badge ${isHealthy ? 'badge-success' : 'badge-error'}`;
        statusTextElement.textContent = isHealthy ? 'Operational' : 'Degraded';
        footerStatusElement.textContent = isHealthy ? 'All Systems Operational' : 'Degraded Performance';
        
        // Latency
        this.updateMetricValue('responseTime', responseTime, 'ms');
        const responseDeltaElement = document.getElementById('responseDelta');
        responseDeltaElement.textContent = `${responseTime} ms`;
        responseDeltaElement.className = 'status-delta positive';
        
        // Uptime from health.system.uptime or health.uptime
        const uptimeSeconds =
          (data.system && typeof data.system.uptime === 'number') ? data.system.uptime :
          (typeof data.uptime === 'number' ? data.uptime : null);
        if (uptimeSeconds != null) {
          const uptimeText = this.formatUptime(uptimeSeconds);
          this.updateMetricValue('uptime', uptimeText, '');
        }
        
        // Service statuses from dependencies
        this.updateServiceStatuses(data);
        
        this.state.previousHealth = data;
        this.state.lastUpdate = new Date();
        this.triggerStatusAnimation();
      }
      
      updateSystemInfoDisplay(info) {
        // Environment + version
        if (info.application) {
          if (info.application.environment) {
            document.getElementById('environmentDisplay').textContent = info.application.environment;
          }
          if (info.application.version) {
            document.getElementById('versionDisplay').textContent =
              `${info.application.name || 'Tadawul Fast Bridge'} v${info.application.version}`;
          }
          
          // Uptime (fallback)
          if (typeof info.application.uptime === 'number') {
            const uptimeText = this.formatUptime(info.application.uptime);
            this.updateMetricValue('uptime', uptimeText, '');
          }
        }
        
        // Metrics snapshot in placeholder
        const placeholder = document.querySelector('.chart-placeholder');
        if (placeholder && info.system) {
          const memMb = info.system.memory_usage_mb !== undefined
            ? `${info.system.memory_usage_mb.toFixed(1)} MB`
            : 'N/A';
          const cpuPercent = info.system.cpu_percent !== undefined
            ? `${info.system.cpu_percent.toFixed(1)}%`
            : 'N/A';
          const threads = info.system.threads !== undefined
            ? info.system.threads
            : 'N/A';
          const connections = info.system.connections !== undefined
            ? info.system.connections
            : 'N/A';
          
          placeholder.textContent = `CPU ${cpuPercent} ‚Ä¢ Memory ${memMb} ‚Ä¢ Threads ${threads} ‚Ä¢ Connections ${connections}`;
        }
        
        // Providers info used as "Requests info"
        if (info.providers) {
          const value = `${info.providers.available}/${info.providers.total}`;
          this.updateMetricValue('requests', value, '');
          const delta = document.getElementById('requestsDelta');
          if (delta) {
            delta.textContent = 'Providers available';
            delta.className = 'status-delta positive';
          }
        }
      }
      
      updateCacheDisplay(stats) {
        // Cache backend
        if (stats && stats.backend) {
          const backend = stats.backend;
          this.updateMetricValue('cacheHits', backend.toUpperCase(), '');
          
          const cacheDelta = document.getElementById('cacheDelta');
          if (cacheDelta) {
            const memoryItems = stats.memory_cache_size || 0;
            cacheDelta.textContent = `Memory items: ${memoryItems}`;
            cacheDelta.className = 'status-delta positive';
          }
          
          const cacheStatusEl = document.getElementById('cacheStatus');
          if (cacheStatusEl) {
            const redisConnected = stats.redis_connected === true;
            if (backend === 'redis' && !redisConnected) {
              cacheStatusEl.className = 'badge badge-warning';
              cacheStatusEl.textContent = 'Memory Only';
            } else {
              cacheStatusEl.className = 'badge badge-success';
              cacheStatusEl.textContent = backend === 'redis' ? 'Redis' : 'Memory';
            }
          }
        }
      }
      
      updateServiceStatuses(healthData) {
        const deps = healthData.dependencies || {};
        
        // Cache via dependencies if present
        const cacheStatus = deps.cache || healthData.status;
        const cacheStatusEl = document.getElementById('cacheStatus');
        if (cacheStatusEl) {
          const isOk = cacheStatus === 'healthy';
          cacheStatusEl.className = `badge ${isOk ? 'badge-success' : 'badge-warning'}`;
          cacheStatusEl.textContent = isOk ? 'Healthy' : 'Degraded';
        }
        
        // API server uses global status
        const apiStatusEl = document.getElementById('apiStatus');
        if (apiStatusEl) {
          const isOk = healthData.status === 'healthy';
          apiStatusEl.className = `badge ${isOk ? 'badge-success' : 'badge-error'}`;
          apiStatusEl.textContent = isOk ? 'Running' : 'Issue';
        }
        
        // Sheets & GAS ‚Äì we don't have explicit flags in /health yet, so mark as Unknown/Configured
        const sheetsStatusEl = document.getElementById('sheetsStatus');
        if (sheetsStatusEl) {
          sheetsStatusEl.className = 'badge badge-neutral';
          sheetsStatusEl.textContent = 'Configured';
        }
        const gasStatusEl = document.getElementById('gasStatus');
        if (gasStatusEl) {
          gasStatusEl.className = 'badge badge-neutral';
          gasStatusEl.textContent = 'Configured';
        }
      }
      
      updateMetricValue(elementId, value, suffix = '') {
        const el = document.getElementById(elementId);
        if (!el) return;
        
        if (typeof value === 'number') {
          el.textContent = this.formatNumber(value) + suffix;
        } else {
          el.textContent = value + (suffix || '');
        }
      }
      
      handleHealthError() {
        const statusElement = document.getElementById('systemStatus');
        const statusTextElement = document.getElementById('statusText');
        const footerStatusElement = document.getElementById('footerStatus');
        
        if (statusElement) statusElement.className = 'badge badge-error';
        if (statusTextElement) statusTextElement.textContent = 'Offline';
        if (footerStatusElement) footerStatusElement.textContent = 'System Unavailable';
        
        ['responseTime', 'uptime', 'requests', 'cacheHits'].forEach(id => {
          const el = document.getElementById(id);
          if (el) el.textContent = '--';
        });
        
        ['sheetsStatus', 'gasStatus', 'cacheStatus', 'apiStatus'].forEach(id => {
          const el = document.getElementById(id);
          if (el) {
            el.className = 'badge badge-error';
            el.textContent = 'Offline';
          }
        });
      }
      
      triggerStatusAnimation() {
        const statusElement = document.getElementById('systemStatus');
        if (!statusElement) return;
        statusElement.style.animation = 'none';
        setTimeout(() => {
          statusElement.style.animation = 'pulse 2s infinite';
        }, 10);
      }
      
      formatUptime(seconds) {
        if (!seconds && seconds !== 0) return '--';
        const days = Math.floor(seconds / 86400);
        const hours = Math.floor((seconds % 86400) / 3600);
        const minutes = Math.floor((seconds % 3600) / 60);
        
        if (days > 0) return `${days}d ${hours}h`;
        if (hours > 0) return `${hours}h ${minutes}m`;
        return `${minutes}m`;
      }
      
      formatNumber(num) {
        if (typeof num !== 'number') return num;
        if (num >= 1_000_000) return (num / 1_000_000).toFixed(1) + 'M';
        if (num >= 1_000) return (num / 1_000).toFixed(1) + 'K';
        return num.toString();
      }
      
      refreshAll() {
        console.log('Manual dashboard refresh (Ctrl+R) ‚Äì API calls only.');
        this.checkHealth();
        this.fetchSystemInfo();
        this.fetchCacheStats();
        
        const cards = document.querySelectorAll('.card');
        cards.forEach(card => {
          card.style.transform = 'scale(0.98)';
          setTimeout(() => {
            card.style.transform = '';
          }, 200);
        });
      }
      
      exportMetrics() {
        return {
          health: this.cache.healthData,
          system: this.cache.systemInfo,
          cache: this.cache.cacheStats,
          lastUpdate: this.state.lastUpdate,
          version: this.state.version,
        };
      }
    }
    
    // Initialize dashboard when DOM is loaded
    document.addEventListener('DOMContentLoaded', () => {
      // Create dashboard instance
      window.dashboard = new DashboardMonitor();
      
      // Card entrance animation
      const cards = document.querySelectorAll('.card');
      cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        setTimeout(() => {
          card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
          card.style.opacity = '1';
          card.style.transform = 'translateY(0)';
        }, index * 100);
      });
      
      // Endpoint tile click behaviour
      const endpointItems = document.querySelectorAll('.endpoint-item');
      endpointItems.forEach(item => {
        item.addEventListener('click', () => {
          const path = item.querySelector('.endpoint-path').textContent.trim();
          const method = item.querySelector('.endpoint-method').textContent.trim();
          
          // Visual feedback
          item.style.transform = 'scale(0.98)';
          setTimeout(() => {
            item.style.transform = '';
          }, 200);
          
          // Copy to clipboard for quick testing
          const fullUrl = `${window.location.origin}${path.replace(':symbol', '{symbol}')}`;
          navigator.clipboard?.writeText(`${method} ${fullUrl}`).catch(() => {});
          
          console.log(`Endpoint clicked: ${method} ${fullUrl}`);
        });
      });
      
      // Smooth scrolling for internal navigation
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          const href = this.getAttribute('href');
          if (!href || href === '#') return;
          e.preventDefault();
          
          const targetElement = document.querySelector(href);
          if (targetElement) {
            window.scrollTo({
              top: targetElement.offsetTop - 80,
              behavior: 'smooth'
            });
          }
        });
      });
    });
    
    // Global helper functions (optional)
    window.formatNumber = function(num) {
      if (typeof num !== 'number') return num;
      return num.toLocaleString('en-US');
    };
    
    window.formatBytes = function(bytes, decimals = 2) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const dm = decimals < 0 ? 0 : decimals;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
    };
  </script>
</body>
</html>
