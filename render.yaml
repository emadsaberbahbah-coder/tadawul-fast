services:
  - type: web
    name: tadawul-fast-bridge
    env: python
    plan: free
    autoDeploy: true

    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn main:app --host 0.0.0.0 --port $PORT --proxy-headers --forwarded-allow-ips="*"

    healthCheckPath: /health

    envVars:
      - key: PYTHON_VERSION
        value: 3.11.9

      - key: APP_NAME
        value: Tadawul Fast Bridge
      - key: APP_VERSION
        value: 4.6.0
      - key: APP_ENV
        value: production
      - key: LOG_LEVEL
        value: INFO

      # IMPORTANT: KSA-safe provider policy (informational list)
      - key: ENABLED_PROVIDERS
        value: "fmp,yfinance"
      - key: PRIMARY_PROVIDER
        value: "fmp"
      - key: KSA_DISALLOW_EODHD
        value: "true"
